{% extends 'base_post.jinja2' %}

{% block post_content %}
	<p>I&#8217;ll try to make it fast. So, for those who just want to see the code, you can clone it from the <a href="https://github.com/pleasedontbelong/cakephp2.x-filter-search-example" target="_blank">github repository.</a> Feel free to fork it, improve it, add issues, etc.</p>
<p>Now, for those who are still reading this article n_n. A few time I have been asked to add some filtering and basic search on paginated lists baked with cakephp. The principle is quite simple, we need a form with some few inputs or selects (our filters), and pass those parameters to the $paginate variable on the controller.</p>
<p>We need to have those filter parameters on the url because if we only work with POST parameters we will lose all of our filters as soon as we change the page, obviously because our pagination numbers are just links. So the first thing to do is to transform the POST sended by the form into <a href="http://book.cakephp.org/2.0/en/development/routing.html#named-parameters" target="_blank">named parameters</a>. We could (maybe) set the form method attribute to &#8220;get&#8221; but I prefer not to, because we could end up with urls that have both named parameters and GET parameters. Witch looks ugly &#8220;/test/page:1/sort:title/?parameter=value&#8221;</p>
<h2>The Data-model</h2>
<p>It&#8217;s a simple model to paginate a list of movies by the genre or the director. It will include a basic search on the title and description of the movie</p>
<h2>The View (index.ctp)</h2>
<div style="font-size:10px; line-height:1.3em">
<div class="wrap_githubgist" style="width:100%"><script src = "http://gist-it.sudarmuthu.com/github/pleasedontbelong/cakephp2.x-filter-search-example/blob/master/app/View/Movies/index.ctp?slice=6:28&footer=minimal"></script></div>
</div>
<h2>The Controller (MoviesController.php)</h2>
<div style="font-size:10px; line-height:1.3em">
<div class="wrap_githubgist" style="width:100%"><script src = "http://gist-it.sudarmuthu.com/github/pleasedontbelong/cakephp2.x-filter-search-example/blob/master/app/Controller/MoviesController.php?slice=15:70&footer=minimal"></script></div>
</div>
<h2>A few notes</h2>
<ul>
<li>I&#8217;m using a very simple search here, just a like. But all I wanted was to show you the basic algorithm for filtering.</li>
<li>In order to respect the DRY principle, you might want to put this code inside a component and a helper</li>
<li>You could use some rewrite rules to make beautiful urls to improve the SEO.</li>
<li>In this example I am only using 1xN relationships. If you want to filter NxN relations, you&#8217;ll need to work a little more on the controller side (making manual joins).</li>
</ul>
<p>Hope this helps :). Please leave a comment if something is not working correctly on the code or post an issue on github. I&#8217;ll write a few unit test later and push it</p>
<div class="addtoany_share_save_container addtoany_content_bottom"><div class="a2a_kit a2a_kit_size_32 addtoany_list a2a_target" id="wpa2a_1"><a class="a2a_button_facebook" href="http://www.addtoany.com/add_to/facebook?linkurl=http%3A%2F%2Fwww.pabloleanomartinet.com%2Fcakephp-2-x-filter-basic-search-example%2F&amp;linkname=CakePHP%202.x%20Filter%20and%20Basic%20search%20with%20pagination%20example" title="Facebook" rel="nofollow" target="_blank"></a><a class="a2a_button_twitter" href="http://www.addtoany.com/add_to/twitter?linkurl=http%3A%2F%2Fwww.pabloleanomartinet.com%2Fcakephp-2-x-filter-basic-search-example%2F&amp;linkname=CakePHP%202.x%20Filter%20and%20Basic%20search%20with%20pagination%20example" title="Twitter" rel="nofollow" target="_blank"></a><a class="a2a_button_google_plus" href="http://www.addtoany.com/add_to/google_plus?linkurl=http%3A%2F%2Fwww.pabloleanomartinet.com%2Fcakephp-2-x-filter-basic-search-example%2F&amp;linkname=CakePHP%202.x%20Filter%20and%20Basic%20search%20with%20pagination%20example" title="Google+" rel="nofollow" target="_blank"></a><a class="a2a_dd addtoany_share_save" href="https://www.addtoany.com/share_save"></a>
<script type="text/javascript"><!--
wpa2a.script_load();
//--></script>
</div></div>
{% endblock %}
